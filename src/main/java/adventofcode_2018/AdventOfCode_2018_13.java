package adventofcode_2018;

import java.util.ArrayList;
import java.util.List;
import java.util.stream.Collectors;

public class AdventOfCode_2018_13 {

    static int total = 0;

    static List<Piece> pieces = new ArrayList<>();
    static String input = "                                                                 /-----------------------------------------------------------------------*            \n" +
            "              /----------*                                       |                             /-----------------------------------------+---------*  \n" +
            "              |          |            /--------------------------+-----* /---------------------+----------------------------------*      |         |  \n" +
            "            /-+----------+-----*      |                 /--------+-----+-+---------------------+----------------------------------+------+---*     |  \n" +
            "    /-------+-+--*       |     |      |                 |  /-----+-----+-+---------------------+-------------------*              |      |   |     |  \n" +
            "    |       | |  |       |     |      |                 |  |     |     | |   /-----------------+-*   /-------------+*             |      |   |     |  \n" +
            "    |       | |  |/------+-----+---*  |               /-+--+-----+-----+-+---+-----------------+-+---+---------*   ||             |      |   |     |  \n" +
            "    |       | |  ||      |     |   |  |             /-+-+--+----<+-----+-+---+-----------------+-+---+---------+---++-------------+----* |   |     |  \n" +
            "    |       | |  ||      |    /+---+--+------------*| | |  |     |     | |   |                 | |   |         |   ||             |    | |   |     |  \n" +
            "    |       | |  ||      |    ||   |  |          /-++-+-+--+-----+-----+-+---+-----------------+-+---+---------+-* ||             |    | |   |     |  \n" +
            "    |       | | /++------+----++---+--+----------+-++-+-+--+-----+-----+-+---+-----------------+-+---+-------* | | ||             |    | |   |     |  \n" +
            "    |       | | |||      |/---++---+--+----------+-++-+-+--+*    |     | |   |                 | |   |       | | | ||             |    | |   |     |  \n" +
            "    |       | | |||      ||  /++---+--+----------+-++-+-+--++*   |     | |  /+----------*      | |   |       | | | ||             |    | |   |     |  \n" +
            "    |   /---+-+-+++------++--+++---+--+----------+-++-+-+--+++---+-*   | *--++----------+------+-+---+-------+-+-+-++-------------/    | |   |     |  \n" +
            "    |/--+---+-+-+++------++--+++---+--+--*      /+-++-+-+--+++---+-+---+----++----------+------+-+---+-------+-+-+-++------------------+-+*  |     |  \n" +
            "    ||  |   | | |||      ||  |||   | /+--+------++-++-+-+--+++---+-+---+----++--------* |      | |   |   /---+-+-+-++------------------+-++--+-*   |  \n" +
            "    ||  |   | | |||      ||  |||  /+-++--+------++-++-+-+--+++---+-+*  |    ||        | |      | |   *---+---+-+-+-+/                  | ||  | |   |  \n" +
            "    ||  |   | | |||      ||  |||  || ||  |      || || | |  |||  /+-++--+----++--------+*|      | |      /+---+-+-+-+-------*           | ||  | |   |  \n" +
            "    ||  |   | | |||      ||  |||  || ||  |      || || | |  |||  || ||  |    ||     /--+++-----*| |      ||   | | | |       |           | ||  | |   |  \n" +
            "    ||  |   | | |||      ||  |||  || ||  |      || || | |  |||  || ||  |    ||     |  |||     || |      ||   | | | |       |       /---+-++--+-+--*|  \n" +
            "    ||/-+---+-+-+++*     ||  |||  || ||  |      || || | |/-+++--++-++--+----++-----+--+++-----++-+------++---+-+-+-+*      |       |   | ||  | |  ||  \n" +
            "    ||| |   | | ||||     ||  |||  || ||  |      || || | || |||  || ||  |    ||     | /+++-----++-+------++>--+-+-+-++-*    |       |   | ||  | |  ||  \n" +
            "    ||| *---+-+-++++-----++--+++--++-++--+------++-++-+-++-+++--++-/|  |    ||     | ||||     ||/+------++---+-+-+-++-+---*|       |   | ||  | |  ||  \n" +
            "    |||     | | ||||     ||  |||  || ||  |      || || | || |||  ||  |  |    ||     | ||||     ||||      ||   | | | || |   ||       |   | ||  | |  ||  \n" +
            "    |||     | | ||||     ||  |||  || ||  |/-----++-++-+-++-+++-*||  |  |    ||     | ||||     ||||      ||   | | | || |   ||       |   | ||  | |  ||  \n" +
            "    |||     | | ||||  /--++--+++--++-++--++-----++-++-+-++-+++-+++--+--+----++-----+-++++-----++++------++---+-+-+-++-+---++------*|   | ||  | |  ||  \n" +
            "    *++-----+-+-+/||  |  ||  |||  || |*--++-----++-++-+-++-+++-+++--+--/    ||     | ||||     ||||      ||   | | | || |   ||      ||   | ||  | |  ||  \n" +
            "     ||     | | | ||  |  ||  |||  || |   ||     v| || | || ||| |||  |       ||     | ||||     ||||      ||   | | | || |   ||    /-++---+-++--+-+-*||  \n" +
            "     ||     | | | ||  |  ||  |||  || |   ||     || ||/+-++-+++-+++--+-*     ||     | ||||     ||||      ||   | | | || |   ||    | ||   | ||  | | |||  \n" +
            "     ||     | | | ||  |  ||  |*+--++-+---++-----++-/||| || ||| |||  | |     ||     | ||||     ||||      ||   | |/+-++-+---++----+-++---+-++--+*| |||  \n" +
            "     ||     | | | ||  |  ||  | |  || |   ||     ||  ||| || ||| |||  | |     ||     | ||||     ||||      *+---+-+++-++-+---+/    | ||   | ||  ||| |||  \n" +
            "     ||/----+-+-+-++--+--++--+-+--++-+---++-----++--+++-++-+++-+++--+-+-----++-----+-++++---* ||||  /----+---+-+++-++-+---+-----+-++---+-++-*||| |||  \n" +
            "     |||  /-+-+-+-++--+--++--+-+--++-+---++-----++--+++-++-+++-+++--+-+-----++-----+-++++---+-++++--+----+--*| ||| || |   |     | |*---+-++-++++-+/|  \n" +
            "     |||  | | | | ||  |  ||  | |  || |   ||     ||  ||| || ||| |||  | |    /++-----+-++++---+-++++--+----+--++-+++-++-+---+-----+-+-*  | || |||| | |  \n" +
            "     |||  | | *-+-++--+--/|  | |  || |   ||     ||  ||| || ||| |||  | |    |||     | ||||   | ||||  |    |  || ||| || |   |     | | |  | || |||| | |  \n" +
            "     |||  | |   | ||  |   |  | |  || |   ||     ||  ||| || ||| |||  | |    |||     | ||||   | |*++--+----+--++-+++-++-+---+-----+-+-+--+-++-++++-+-/  \n" +
            "     |||  | *---+-++--+---+--+-/  || |   |*-----++--+++-++-+++-/||  | |    |||     | ||||   | | ||  |    |  || ||| || |   |     | | |  | || |||| |    \n" +
            "     |||  | /---+-++--+---+--+*   *+-+---+------++--+++-++-+++--++--/ |  /-+++-----+-++++---+-+-++--+--* |  || ||| || |   |     | | |  | || |||| |    \n" +
            "     *++--+-+---+-++--+---+--++----+-+---/      ||  ||| || |||  ||    |/-+-+++-----+-++++---+-+-++--+--+-+--++-+++-++-+---+-----+-+-+--+-++-++++-+---*\n" +
            "      ||  | |/--+-++--+---+-*||    | |          ||  ||| || |||  ||    || | |||     | ||||   | | ||  |  | |  || ||| || |   |     | | |  | || |||| |   |\n" +
            "      ||  | ||  | ||  |   | |||    | |  /-------++--+++-++-+++--++----++-+-+++-----+-++++---+-+-++--+--+-+--++*||| || |   |     | | |  | || |||| |   |\n" +
            "     /++--+-++--+-++--+---+-+++----+-+--+-------++--+++-++-+++--++----++-+-+++*    | ||||   | | || /+--+-+--++++++-++-+---+-----+-+-+* | || |||| |   |\n" +
            "     |||  | || /+-++--+---+-+++----+-+--+---*   ||  ||| || |||  ||    || | ||||    | ||||   | | || ||  | |  |||||| || |   |     | | || | || |||| |   |\n" +
            "    /+++--+-++-++-++--+---+-+++----+-+--+---+---++--+++-++-+++--++----++-+*||||    | ||||   | | || ||  |/+--++++++-++-+<--+---* | | || | || |||| |   |\n" +
            "    ||||  | || || ||  |   | |||    | | /+---+---++--+++-++-+++--++----++-++++++----+-++++---+-+-++-++--+++--++++++-++-+---+---+-+*| || | || |||| |   |\n" +
            "    |||| /+-++-++-++--+---+-+++----+-+-++---+---++--+++-++-+++--++----++-++++++--* | ||||   | | || || /+++--++++++-++-+---+---+-+++-++*| || |||| |   |\n" +
            "    |||| ||/++-++-++--+---+-+++----+-+-++-* |   ||  ||| || ||| /++----++-++++++--+-+-++++---+-+-++-++-++++--++++++-++-+---+---+-+++-++++-++-++++*|   |\n" +
            "    ||*+-+++++-++-+/  |   | |||    | | || | |  /++--+++-++-+++-+++----++-++++++--+-+-++++---+-+-++-++-++++--++++++-++-+---+---+-+++-++++*|| ||||||   |\n" +
            "/---++-+-+++++-++-+---+---+-+++----+-+-++-+-+--+++--+++-++-+++-+++----++-++++++--+-+-++++---+-+-++-++*||||  |||||| || |   |   | ||| ||||||| ||||||   |\n" +
            "|   || | ||||| || |   |   | |||  /-+-+-++-+*|  |||  ||| || ||| |||    || ||||||  | | ||||   | | || |||||||  |||||| || |   |   | ||| ||||||| ||||||   |\n" +
            "|   || | |^||| || |   |   | |||  | | | || |||  |||  ||| || ||| |||    || ||||*+--+-+-++++---+-+-+/ |||||||  |||||| || |   |   | ||| ||||||| ||||||   |\n" +
            "|   || | ||||| || |   |  /+-+++--+-+-+-++-+++--+++--+++-++-+++-+++----++-++++-+--+-+-++++---+-+-+--+++++++--++++++-++-+---+--*| ||| ||||||| ||||||   |\n" +
            "|   || | ||||| || |   |  || |||  | | | || |||  |||  ||| || ||| |||    |*-++++<+--+-+-++++---+-+-+--+++++++--++++++-++-+---+--++-+++-+++++++-++++++---/\n" +
            "|   || | ||||| || |   |  || |||  | | | || |||  |||  ||| ||/+++-+++----+--++++-+--+-+-++++---+-+-+--+++++++--++++++-++-+---+--++*||| ||||||| |v||||    \n" +
            "|   || | ||||| *+-+---+--++-+++--+-+-+-++-++/  |||  ||| |||||| |||    |  |||| |  | | ||||   | | |  |||||||  |||||| || |   |  |||||| ||||||| ||||||    \n" +
            "|   || | |||||  | |   |  || |||  | | |/++-++---+++--+++-++++++-+++-*  |  |||| |  | | ||||   | | |  |||||||  |||||| || |   |  |||||| ||||||| ||||||    \n" +
            "|   || | |||||  | |   |  || |||  | | |||| ||   |||  ||| |||||| ||| |  |  |||| |  | *-++++---+-/ |  |||||||  |||||| || |   |  |||*++-+++++++-+++++/    \n" +
            "|   || | |||||  ^ |   |  || |*+--+-+-++++-++---+++--+++-+++++/ ||| |  |  |||| |  |   ||||   |   |  |||||||  |||||| || |   |  ||| || ||||||| |||||     \n" +
            "|   || | |||||  | |   |  || | |  | | |||| ||   |||  ||| |||||  ||| |  |  |||| |  |   ||||   |   |  |||||||  |||||| || |   |  ||| || ||||||| |||||     \n" +
            "|   || | |||||  | |   |  || | |  | | |||| ||   |||  ||| |||||  ||| |  |  |||| |  |   ||||   |   |  |||||||  |||||^ || v   |  ||| || ||||||| |||||     \n" +
            "|   || | |||||  | |   |  || | |  | | |||| ||   |||  ||| |||||  ||| |  |  |||| |  |   ||||   |   |  ||||||*--++++++-++-+---+--+++-++-+++++++-+++/|     \n" +
            "|   || | |||||  | |   |  || | |  | | |||| ||   |||  ||| |||||  ||| |/-+--++++-+--+---++++---+---+--++++++---++++++-++-+---+--+++-++-+++++++-+++-+-*   \n" +
            "|   || | ||||| /+-+---+--++-+-+--+-+-++++-++--*|||  ||*-+++++--+++-++-+--++++-+--+---++++---+---+--++++++---+++/|| || | /-+--+++-++-+++++++-+++-+-+--*\n" +
            "|   || | ||||| || |   |  || | |  | | |||| ||  ||||  ||/-+++++--+++-++-+--++++-+-*|   ||||   |   |  ||||||   ||| || || | | |  ||| || ||||||| ||| | |  |\n" +
            "|   || | ||||| || |   |  ||/+-+--+-+-++++-++--++++--+++-+++++--+++-++-+--++++-+-++---++++---+---+--++++++---+++-++-++-+-+*|  ||| || ||||||| ||| | |  |\n" +
            "| /-++-+-+++++-++-+---+--++++-+--+-+-++++-++--++++--+++-+++++--+++-++*|  |||| | ||   ||||   |   |  ||||||   ||| *+-++-+-+++--+++-++-+++++++-++/ | |  |\n" +
            "| | || | ||||| || |   |  |||| |  | | |||| ||/-++++--+++-+++++--+++-++++--++++-+-++---++++--*|   |  ||||||   |||  | || | |||  ||| || ||||||| ||  | |  |\n" +
            "| | || | ||||| || |   |  |||| |  | | |||| ||| ||||  ||| |||||  ||| ||||  |||*-+-++---+++/  ||   |  |||*++---+++--+-++-+-+++--+++-++-++/|||| ||  | |  |\n" +
            "| | || | ||||| || |   |  ||||/+--+-+-++++-+++-++++--+++-+++++--+++-++++--+++--+-++---+++---++---+--+++-++---+++--+-++-+-+++* ||| || || |||| ||  | |  |\n" +
            "| | || | ||||| || |   |  ||||||  | | |||| ||| ||||  ||| |||||  ||| ||||  |||  | ||   |||   ||   |  *++-++---+++--+-++-+-++++-+++-++-+/ |||| ||  | |  |\n" +
            "| | || | ||||| || *---+--++++++--+-/ |||| ||| |*++--+++-+++++--+++-++++--+++--+-++---+++---++---+---++-++---+++--+-++-+-++++-+++-++-+--+/|| ||  | |  |\n" +
            "| | || | ||||| ||     |  ||||||  |   |||| ||| | *+--+++-+++++--+++-++++--+++--+-++---+++---++---+---++-++---+++--+-++-+-++++-+++-++-+--+-+/ ||  | |  |\n" +
            "| | || | ||||| ||     |  ||||||  |   |||| ||| |  |/-+++-+++++--+++-++++--+++--+-++---+++--*||   |   || ||   |||  | || | |||| ||| || |  | |  ||  | |  |\n" +
            "| | || | ||||| ||     |  ||||||  |   |||| ||| |  || ||| |||||  ||| ||||  *++--+-++---+++--+++---+---++-/|   |||  | || | |||| ||| || |  | |  ||  | |  |\n" +
            "| | || | ||*++-++-----+--++++++--+---++++-/|| |  || ||| |||||  ||| ||||  /++--+-++---+++--+++---+*  ||  |   |||  | || | |||| ||| || |  | |  ||  | |  |\n" +
            "| | || | || || ||     |  ||||||  |   ||||  || |  || ||| |||||  ||| |*++--+++--+-++---+++--+++---++--++--+---+++--+-++-+-++++-+++-++-+--+-+--++--+-/  |\n" +
            "| | || |/++-++-++-----+--++++++--+---++++--++*|  || ||| |||*+--+++-+-++--+++--+-++---+++--+++---++--++--+---+++--+-/| | |||| ||| || |  | |  ||  |    |\n" +
            "| | || |||| || ||     |  ||||||  |   ||*+--++++--++-+++-+++-+--+++-+-++--+++--+-++---+++--+++---++--++--+---+++--+--+-+-++++-+++-/| |  | |  ||  |    |\n" +
            "| | || |||| *+-++-----+--+++++/  |   || |  ||||  || ||| ||| |  ||| | ||  |||  | ||   |||  |||   ||  ||  | /-+++--+--+-+-++++-+++--+*|  | |  ||  |    |\n" +
            "| | || ||||  | ||     |  |||||   |   || |  ||||  *+-+++-+++-+--+++-+-++--+++--+-++---+++--+++---++--++--+-+-+++--/  | | |||| |||  |||  | |  ||  |    |\n" +
            "| | || ||||  | ||     |  |||||   |  /++-+--++++---+*|*+-+++-+--+++-+-+/  |||  | ||   |||  |||   ||  ||  | | |v|     | | |||| |||  |||  | |  ||  |    |\n" +
            "| | || ||||  | ||     |  |||||   |  ||| |  ||||   ||| | ||| |  ||| | |   |||  | ||   ||| /+++---++--++--+-+-+++-----+-+-++++-+++--+++--+-+-*||  |    |\n" +
            "| | || |||*--+-++-----+--+++++---+--+++-+--++++---+++-+-+++-+--+++-+-+---+++--+-++---+++-++++---++--++--+-+-/||     | | |||| |||  |||  | | |||  |    |\n" +
            "| | || |||   | ||     |  |||||   |  ||| |  ||||/--+++-+-+++-+--+++-+-+---+++--+-++---+++-++++---++--++--+-+--++-----+-+-++++-+++--+++--+-+-+++--+---*|\n" +
            "| | || |||   | ||     |  |*+++---+--+++-+--+++++--+++-+-+++-/  ||| | |   |||  | ||   ||| ||||   ||  ||  | |  ||     | | |||| |||  |||  | | |||  |   ||\n" +
            "| | || |||   | ||     |  | |||   |  ||| |  |||||  ||| | |||    ||| | | /-+++--+-++---+++-++++---++--++--+-+--++-----+-+-++++-+++--+++--+-+-+++* |   ||\n" +
            "| | || |||   | ||     |  | |||   |  ||| |  |||||  ||| | |||    ||*-+-+-+-+++--+-++---+++-++++---++--++--+-+--++-----+-+-++++-+++--+++--+-/ |||| |   ||\n" +
            "| | || |||   | ||/----+--+-+++---+--+++-+--+++++--+++-+-+++----++--+-+-+-+++--+-++---+++-++++---++--++-*| |  ||     | | |||| |||  |||  |   |||| |   ||\n" +
            "| | || |||   | |||    |  | |||   |  ||| |  |||||  ||| | |||    ||  | | | ||| /+-++---+++-++++---++--++-++-+--++-----+-+-++++-+++--+++* |   |||| |   ||\n" +
            "| | || |||   | *++----+--+-+++---+--+++-+--+++/|  ||| | *++----++--+-+-+-+++-++-++---+++-++++---++--++-++-+--++-----+-+-++++-+++--++++-+---++/| |   ||\n" +
            "| | || |||   |/-++----+--+-+++---+--+++-+--+++-+--+++-+--++----++--+-+-+-+++-++-++---+++-++++---++--++-++-+-*||     | | |||| |||  |||| |   || | |   ||\n" +
            "| | || |||   || ||    |  | |||   |  ||| |  ||| |  ||| |  ||    ||  | | |/+++-++-++---+++-++++--*||  || || | |||     | | |||| |||  |||| |   || | |   ||\n" +
            "| | |*-+++---++-++----+--+-+++---+--+++-+--+++-+--+++-+--++----++--+-+-+++++-+/ ||   ||| ||||  |||  || || | |||     | | |||| |||  |||| |   || | |   ||\n" +
            "| |/+--+++---++-++----+--+-+++---+--+++-+--+++-+--+++-+--++----++--+-+-+++++-+--++---+++-++++* |||  || || | |||     | | |||| |||  |||| |   || | |   ||\n" +
            "| |||  |||   || ||    | /+-+++---+--+++-+--+++-+--+++-+--++----++-*| | ||||| |  ||   ||| ||||| |||  || || | |||     | | |||| |||  |||| |   || | |   ||\n" +
            "| |||  |||   || ||    | || |||   |  ||| |  ||| |  ||| |  ||    |*-++-+-+++++-+--++---++/ ||||| |||  || || | |||     | | |||| |||  |||| |   || | |   ||\n" +
            "| |||  |||   || ||  /-+-++-+++---+--+++-+-*||| |  ||| |  ||    |  || | |||||/+--++---++--+++++-+++--++-++-+*|||     | | |||| |||  |||| |   || | |   ||\n" +
            "| |||  |||   || ||  | | ||/+++---+--+++-+-++++-+--+++-+-*||    |  || | |||||||  ||   *+--+++++-+++--++-++-+++++-----+-/ |||| |||  ||||/+---++-+-+-* ||\n" +
            "| |||  |||   || ||  | | ||||||   |  ||| | |||| |  *++-+-+++----+--++-+-+++++++--++----+--+/||| |||  || || |||||     |   |||| |||  ||||||   || | | | ||\n" +
            "| |||  ||v   || ||  | | ||||||   |  ||| | |||| |   || | |||    |  || | *++++++--++----+--+-+++-+++--++-++-+++++-----+---++++-+++--++++++---++-/ | | ||\n" +
            "|/+++--+++---++-++--+-+*||||||   |  ||| | |||| |   || | |||    |  || |  ||||||  ||    |  | ||| |||  || || |||||     |   |||| |||  ||||||   ||   | | ||\n" +
            "|||||  |||   || ||  | ||||||||   |  ||| | |||| |   |*-+-+++----+--++-+--++++++--++----+--+-+++-+++--++-++-+++++-----+---++++-+++--+++++/   ||   | | ||\n" +
            "|||||  |||   || ||  | *+++++++---+--+++-+-++++-+---+--+-+++----+--++-+--++++++--++----+--+-+++-+++--++-++-+++++-----+---++++-+++--/||||    ||   | | ||\n" +
            "|||||  |||   || ||  |/-+++++++---+--+++-+-++++-+---+--+-+++----+--++-+--++++++--++----+--+-+++-+++--++-++-+++++-----+*  |||| |||   ||||    ||   | | ||\n" +
            "|||||  |||   || *+--++-+++++++---+--+++-+-++++-+---+--+-+++----+--++-+--++++++--++----+--+-+++-+++--++-++-+++/|     ||  |||| |||   ||||    ||   | | ||\n" +
            "|||||  |||   ||  |  || |||||||   |  ||| | |||| |   |  | |||    |  || |  ||||||  ||    |  | ||| |||  || || ||| |     ||  |||| |||   ||||    ||   | | ||\n" +
            "|||||  |||   ||  |  || |||||||   |  |*+-+-++++-+---+--+-+++----+--++-+--++++++--++----/  | ||| |||  || || ||| |     ||  |||| |||   ||||    ||   | | ||\n" +
            "|||||  |||   ||  |  || |||||||   |  *-+-+-++++-+---/  *-+++----+--++-+--++++++--/|       | ||| |*+--++-++-+++-+-----++--++/| |||   ||||    ||   | | ||\n" +
            "||*++--+++---++--+--++-+++++++---+----+-+-++++-+--------+++----+--++-/  ||||||   |   /---+-+++-+-+--++-++-+++-+-----++-*|| |/+++---++++----++--*| | ||\n" +
            "|| ||  |||  /++--+--++-+++++++---+----+-+-++++-+--------+++----+--++----++++++---+---+---+-+++-+-+--++-++-+++-+----*|| ||| |||||   ||||    ||  || | ||\n" +
            "|| ||  |||  |||  |  || |||||||   |    | *-++++-+--------+++----+--++----++++++---+---+---+-+++-+-+--++-++-+++-/    ||| ||| |||||   ||||    ||  || | ||\n" +
            "|| ||  ^*+--+++--+--++-+++++++---+----+---+++/ |        |||    |  ||    ||||||   |   |   | ||| | |  || |*-+++------+++-+++-+++/|   ||||    ||  || | ||\n" +
            "|| ||  | |  |||  |  || |||||||   |    |   |||  |        |||    |  ||    ||||||   |   |   | ||| | |  || |  |||      ||| ||| ||| |   ||||    ||  || | ||\n" +
            "|| ||  | |  |||  |  *+-+++++++---+----+---/||  |        |*+----+--++----++++++---+---+---+-+++-+-+--++-+--+++------+/| ||| ||| |   ||||    ||  || | ||\n" +
            "|| ||  | |  |||  |   | |||||||   |    |    ||  |        | |    |  ||   /++++++---+--*|   | ||| | |  || |  |||      | | ||| ||| |   ||||    ||  || | ||\n" +
            "|| ||  | |  |||  |   *-+++++++---+----+----++--+--------+-+----+--++---+++++++---+--++---+-+++-+-+--++-+--+++------+-/ ||| ||| |   ||||    ||  || | ||\n" +
            "|| ||  *-+--+++--+-----+++++++---+----+----++--+--------+-+----+--++---+++++++---+--++---+-+/| | |  *+-+--+++------+---+++-+++-+---++++----+/  || | ||\n" +
            "|*-++----+--+++--+-----/||||||   |    |    ||  |        | |    |  ||   |||||||   |  |*---+-+-+-+-+---+-+--+++------+---/|| ||| |   ||||    |   || | ||\n" +
            "|  ||    |  |||  |      ||||||   |    |    ||  |        | |    |  ||   ||||||*---+--+----+-+-+-+-+---+-+--+++------+----++-+++-+---++/|    |   || | ||\n" +
            "|  ||    |  |||  |      |*++++---+----+----++--+--------+-+----+--++---++++++----+--+----+-+-+-+-+---+-+--+++------+----++-++/ |   || |    |   || | ||\n" +
            "|  ||    |  |||  |   /--+-++++---+----+----++--+--------+-+----+--++---++++++--* |  |    | | | | |   | |  |||      |    || ||  |   || |    |   || | ||\n" +
            "|  ||    |  |||  |   |  | ||||   |    |    |*--+--------+-+----+--++---++++++--+-+--+----+-/ | | |   | |  ||v      |    || ||  |   || |    |   || | ||\n" +
            "|  ||    |  |||  *---+--+-++++---+----+----+---+--------+-+----+--++---++++++--+-+--+----+---+-+-+---+-/  |||      |    || ||  |   || |    |   || | ||\n" +
            "|  ||    |  |||      |  | |*++---+----+----+---+--------+-+----+--++---++++++--+-+--+----+---+-+-+---+----+++------+----+/ ||  |   || |    |   || | ||\n" +
            "|  ||    |  |||      |  | | ||   |    |   /+---+--------+-+-*  |  || /-++++++--+-+--+---<+---+-+-+---+----+++------+----+-*||  |   || |    |   || | ||\n" +
            "|  ||    |  |||      |  | | ||   |    |   ||   |        | | |  |  || | ||||*+--+-+--+----+---+-+-+---+----+++------+----+-+++--+---+/ |    |   || | ||\n" +
            "|  ||    |  |||      |  *-+-++---+----+---++---+--------+-+-+--+--/| | |||| |  | |  |    |   | | |   |    |||      |    | |||  |   |  |    |   || | ||\n" +
            "|  ||    |  |*+------+----+-/|   |    |   ||   |        | | |  |   | | |||| |  | |  |    |   | | |   |/---+++------+*   | |||  |   |  |    |   || | ||\n" +
            "|  ||    |  | |      |    |  |   |    |   ||   |        | | |  |   | | |||| |  | |  |    |   | | |   ||   |||      ||   *-+++--+---+--+----+---++-+-+/\n" +
            "|  ||    |  *-+------+----+--+---+----+---++---+--------+-+-+--+---+-+-++++-+--+-+--+----+---+-+-+---++---+++------/|     |||  |   |  |    |   || | | \n" +
            "|  ||    |    *------+----+--+---+----+---++---+--------+-+-+--+---+-+-++++-+--+-+--+----+---+-+-+---++---++/       |     |||  |   |  |    |   || | | \n" +
            "*--++----+-----------+----+--+---+----+---++---+--------+-+-+--+---+-+-++++-+--+-+--+----+---+-+-+---/|   ||        |     |||  |   |  |    |   || | | \n" +
            "   ||    *-----------+----+--+---+----+---++---+--------+-+-+--+---+-+-++++-+--+-/  |    |   | | |    |   ||        |     |||  |   |  |    |   || | | \n" +
            "   ||                |    |  *---+----+---++---+--------+-+-+--+---+-+-++++-+--+----+----+---+-+-+----+---++--------+-----+/|  |   |  |    |   || | | \n" +
            "   ||                |    |      |    |   ||   |        | | |  |   | | |||| |  |    |    *---+-+-+----+---++--------+-----+-+--+---+--+----/   || | | \n" +
            "   |*----------------+----+------+----+---++---+--------+-+-+--+---+-+-+++/ |  |    |        | | |    |   *+--------+-----+-+--+---/  |        || | | \n" +
            "   |        /--------+----+------+----+---++---+----<---+-+-+--+---+-+-+++--+--+----+--------+-+-+----+----+--------+*    | |  |      |        || | | \n" +
            "   |        |        |    |      *----+---+/   |        | | |  |   | | |*+--+--+----+--------+-/ |    |    |        ||    | |  |      |        || | | \n" +
            "   |        |        |    |           |   |    *--------+-+-+--+---+-+-+-+--+--+----+--------+---+----+----+--------++----+-+--+------+--------++-+-/ \n" +
            "   *--------+--------+----+-----------+---+-------------+-+-+--+---+-+-+-+--+--+----+--------/   |    |    |        ||    | |  |      |        || |   \n" +
            "            |        |    |           |   |             | | |  |   | | *-+--+--+----/            |    |    |        ||    | |  |      |        || |   \n" +
            "            |        |    |           |   |             | | |  |   | |   |  |  |                 |    |    |        ||    | *--+------+--------/| |   \n" +
            "            |        |    |           *---+-------------+-+-+--+---/ |   |  |  |                 |    *----+--------/|    |    |      |         | |   \n" +
            "            |        |    |               |             | | |  |     |   *--+--+-----------------/         |         |    |    |      |         | |   \n" +
            "            |        |    |               |             | | |  *-----+------+--+---------------------------+---------+----+----+------+---------/ |   \n" +
            "            |        |    |               *-------------+-+-/        |      *--+---------------------------/         |    |    |      |           |   \n" +
            "            |        |    |                             | |          *---------+-------------------------------------+----/    |      *-----------/   \n" +
            "            *--------+----+-----------------------------+-+--------------------+-------------------------------------/         |                      \n" +
            "                     *----+----------->-----------------+-+--------------------/                                               |                      \n" +
            "                          *-----------------------------/ *--------------------------------------------------------------------/                      ";
    static String[] inputs = input.split("\n");

    public static void main(String... args) throws Exception {
        for (int j = 0; j < inputs.length; j++) {
            String input = inputs[j];

            for (int i = 0; i < input.length(); i++) {
                Piece piece = new Piece();
                piece.thisCoordinate = new Coordinate(i, j);
                char c = input.charAt(i);
                if (c == ' ') {
                    continue;
                }
                Character d = null;
                try {
                    d = input.charAt(i + 1);
                } catch (Exception e) {

                }
                if (c == '-') {
                    piece.connectionCoordinate1 = new Coordinate(i - 1, j);
                    piece.connectionCoordinate2 = new Coordinate(i + 1, j);
                } else if (c == '+') {
                    piece.connectionCoordinate1 = new Coordinate(i, j + 1);
                    piece.connectionCoordinate2 = new Coordinate(i - 1, j);
                    piece.connectionCoordinate3 = new Coordinate(i, j - 1);
                    piece.connectionCoordinate4 = new Coordinate(i + 1, j);
                } else if (c == '<') {
                    piece.connectionCoordinate1 = new Coordinate(i - 1, j);
                    piece.connectionCoordinate2 = new Coordinate(i + 1, j);
                    piece.kart = new Kart();
                    piece.kart.prev = new Piece();
                    piece.kart.prev.thisCoordinate= new Coordinate(i + 1, j);
                } else if (c == '>') {
                    piece.connectionCoordinate1 = new Coordinate(i - 1, j);
                    piece.connectionCoordinate2 = new Coordinate(i + 1, j);
                    piece.kart = new Kart();
                    piece.kart.prev = new Piece();
                    piece.kart.prev.thisCoordinate= new Coordinate(i - 1, j);
                } else if (c == '^') {
                    piece.connectionCoordinate1 = new Coordinate(i, j + 1);
                    piece.connectionCoordinate2 = new Coordinate(i, j - 1);
                    piece.kart = new Kart();
                    piece.kart.prev = new Piece();
                    piece.kart.prev.thisCoordinate= new Coordinate(i, j + 1);
                } else if (c == 'v') {
                    piece.connectionCoordinate1 = new Coordinate(i, j + 1);
                    piece.connectionCoordinate2 = new Coordinate(i, j - 1);
                    piece.kart = new Kart();
                    piece.kart.prev = new Piece();
                    piece.kart.prev.thisCoordinate= new Coordinate(i, j - 1);
                } else if (c == '|') {
                    piece.connectionCoordinate1 = new Coordinate(i, j - 1);
                    piece.connectionCoordinate2 = new Coordinate(i, j + 1);
                } else if (c == '*') {

                    if (d == null || d == ' ' || d == '|') {
                        piece.connectionCoordinate2 = new Coordinate(i, j + 1);
                        piece.connectionCoordinate1 = new Coordinate(i - 1, j);
                    } else {
                        piece.connectionCoordinate2 = new Coordinate(i, j - 1);
                        piece.connectionCoordinate1 = new Coordinate(i + 1, j);
                    }
                } else if (c == '/') {
                    if (d == null || d == ' ' || d == '|') {
                        piece.connectionCoordinate2 = new Coordinate(i, j - 1);
                        piece.connectionCoordinate1 = new Coordinate(i - 1, j);
                    } else {
                        piece.connectionCoordinate2 = new Coordinate(i, j + 1);
                        piece.connectionCoordinate1 = new Coordinate(i + 1, j);
                    }
                }
                pieces.add(piece);
            }
        }
        while (true) {
            for (Piece piece1 : pieces) {
                if (piece1.kart != null) {

                    if (piece1.connectionCoordinate3 != null) {
                        // Kruispunt
                        if (piece1.kart.prev.thisCoordinate.xvalue == piece1.connectionCoordinate1.xvalue && piece1.kart.prev.thisCoordinate.yvalue == piece1.connectionCoordinate1.yvalue) {
                            switch (piece1.kart.direction) {
                                case "Left":
                                    Coordinate next = piece1.connectionCoordinate2;
                                    Piece piece2 = pieces.stream().filter(piece3 -> piece3.thisCoordinate.xvalue == next.xvalue &&
                                            piece3.thisCoordinate.yvalue == next.yvalue).findFirst().get();
                                    if (piece2.kart != null || piece2.futureKart != null) {
                                        System.out.println("CRASH: " + piece2.thisCoordinate.xvalue + ", " + piece2.thisCoordinate.yvalue);
                                        piece1.kart = null;
                                        piece1.futureKart = null;
                                        piece2.kart = null;
                                        piece2.futureKart = null;
                                        continue;
                                    } else {
                                        piece2.futureKart = piece1.kart;
                                        piece2.futureKart.direction = "Middle";
                                        piece2.futureKart.prev = piece1;
                                    }
                                    break;
                                case "Middle":
                                    Coordinate next2 = piece1.connectionCoordinate3;
                                    Piece piece3 = pieces.stream().filter(piece4 -> piece4.thisCoordinate.xvalue == next2.xvalue &&
                                            piece4.thisCoordinate.yvalue == next2.yvalue).findFirst().get();
                                    if (piece3.kart != null || piece3.futureKart != null) {
                                        System.out.println("CRASH: " + piece3.thisCoordinate.xvalue + ", " + piece3.thisCoordinate.yvalue);
                                        piece1.kart = null;
                                        piece1.futureKart = null;
                                        piece3.kart = null;
                                        piece3.futureKart = null;
                                        continue;
                                    } else {
                                        piece3.futureKart = piece1.kart;
                                        piece3.futureKart.direction = "Right";
                                        piece3.futureKart.prev = piece1;
                                    }
                                    break;
                                case "Right":
                                    Coordinate next3 = piece1.connectionCoordinate4;
                                    Piece piece4 = pieces.stream().filter(piece5 -> piece5.thisCoordinate.xvalue == next3.xvalue &&
                                            piece5.thisCoordinate.yvalue == next3.yvalue).findFirst().get();
                                    if (piece4.kart != null || piece4.futureKart != null) {
                                        System.out.println("CRASH: " + piece4.thisCoordinate.xvalue + ", " + piece4.thisCoordinate.yvalue);
                                        piece1.kart = null;
                                        piece1.futureKart = null;
                                        piece4.kart = null;
                                        piece4.futureKart = null;
                                        continue;
                                    } else {
                                        piece4.futureKart = piece1.kart;
                                        piece4.futureKart.direction = "Left";
                                        piece4.futureKart.prev = piece1;
                                    }
                                    break;
                            }
                        }
                        if (piece1.kart.prev.thisCoordinate.xvalue == piece1.connectionCoordinate2.xvalue && piece1.kart.prev.thisCoordinate.yvalue == piece1.connectionCoordinate2.yvalue) {
                            switch (piece1.kart.direction) {
                                case "Left":
                                    Coordinate next = piece1.connectionCoordinate3;
                                    Piece piece2 = pieces.stream().filter(piece3 -> piece3.thisCoordinate.xvalue == next.xvalue &&
                                            piece3.thisCoordinate.yvalue == next.yvalue).findFirst().get();
                                    if (piece2.kart != null || piece2.futureKart != null) {
                                        System.out.println("CRASH: " + piece2.thisCoordinate.xvalue + ", " + piece2.thisCoordinate.yvalue);
                                        piece1.kart = null;
                                        piece1.futureKart = null;
                                        piece2.kart = null;
                                        piece2.futureKart = null;
                                        continue;
                                    } else {
                                        piece2.futureKart = piece1.kart;
                                        piece2.futureKart.direction = "Middle";
                                        piece2.futureKart.prev = piece1;
                                    }
                                    break;
                                case "Middle":
                                    Coordinate next2 = piece1.connectionCoordinate4;
                                    Piece piece3 = pieces.stream().filter(piece4 -> piece4.thisCoordinate.xvalue == next2.xvalue &&
                                            piece4.thisCoordinate.yvalue == next2.yvalue).findFirst().get();
                                    if (piece3.kart != null || piece3.futureKart != null) {
                                        System.out.println("CRASH: " + piece3.thisCoordinate.xvalue + ", " + piece3.thisCoordinate.yvalue);
                                        piece1.kart = null;
                                        piece1.futureKart = null;
                                        piece3.kart = null;
                                        piece3.futureKart = null;continue;
                                    } else {
                                        piece3.futureKart = piece1.kart;
                                        piece3.futureKart.direction = "Right";
                                        piece3.futureKart.prev = piece1;
                                    }
                                    break;
                                case "Right":
                                    Coordinate next3 = piece1.connectionCoordinate1;
                                    Piece piece4 = pieces.stream().filter(piece5 -> piece5.thisCoordinate.xvalue == next3.xvalue &&
                                            piece5.thisCoordinate.yvalue == next3.yvalue).findFirst().get();
                                    if (piece4.kart != null || piece4.futureKart != null) {
                                        System.out.println("CRASH: " + piece4.thisCoordinate.xvalue + ", " + piece4.thisCoordinate.yvalue);
                                        piece1.kart = null;
                                        piece1.futureKart = null;
                                        piece4.kart = null;
                                        piece4.futureKart = null;continue;
                                    } else {
                                        piece4.futureKart = piece1.kart;
                                        piece4.futureKart.direction = "Left";
                                        piece4.futureKart.prev = piece1;
                                    }
                                    break;
                            }
                        }
                        if (piece1.kart.prev.thisCoordinate.xvalue == piece1.connectionCoordinate3.xvalue && piece1.kart.prev.thisCoordinate.yvalue == piece1.connectionCoordinate3.yvalue) {
                            switch (piece1.kart.direction) {
                                case "Left":
                                    Coordinate next = piece1.connectionCoordinate4;
                                    Piece piece2 = pieces.stream().filter(piece3 -> piece3.thisCoordinate.xvalue == next.xvalue &&
                                            piece3.thisCoordinate.yvalue == next.yvalue).findFirst().get();
                                    if (piece2.kart != null || piece2.futureKart != null) {
                                        System.out.println("CRASH: " + piece2.thisCoordinate.xvalue + ", " + piece2.thisCoordinate.yvalue);
                                        piece1.kart = null;
                                        piece1.futureKart = null;
                                        piece2.kart = null;
                                        piece2.futureKart = null;continue;
                                    } else {
                                        piece2.futureKart = piece1.kart;
                                        piece2.futureKart.direction = "Middle";
                                        piece2.futureKart.prev = piece1;
                                    }
                                    break;
                                case "Middle":
                                    Coordinate next2 = piece1.connectionCoordinate1;
                                    Piece piece3 = pieces.stream().filter(piece4 -> piece4.thisCoordinate.xvalue == next2.xvalue &&
                                            piece4.thisCoordinate.yvalue == next2.yvalue).findFirst().get();
                                    if (piece3.kart != null || piece3.futureKart != null) {
                                        System.out.println("CRASH: " + piece3.thisCoordinate.xvalue + ", " + piece3.thisCoordinate.yvalue);
                                        piece1.kart = null;
                                        piece1.futureKart = null;
                                        piece3.kart = null;
                                        piece3.futureKart = null;continue;
                                    } else {
                                        piece3.futureKart = piece1.kart;
                                        piece3.futureKart.direction = "Right";
                                        piece3.futureKart.prev = piece1;
                                    }
                                    break;
                                case "Right":
                                    Coordinate next3 = piece1.connectionCoordinate2;
                                    Piece piece4 = pieces.stream().filter(piece5 -> piece5.thisCoordinate.xvalue == next3.xvalue &&
                                            piece5.thisCoordinate.yvalue == next3.yvalue).findFirst().get();
                                    if (piece4.kart != null || piece4.futureKart != null) {
                                        System.out.println("CRASH: " + piece4.thisCoordinate.xvalue + ", " + piece4.thisCoordinate.yvalue);
                                        piece1.kart = null;
                                        piece1.futureKart = null;
                                        piece4.kart = null;
                                        piece4.futureKart = null;continue;
                                    } else {
                                        piece4.futureKart = piece1.kart;
                                        piece4.futureKart.direction = "Left";
                                        piece4.futureKart.prev = piece1;
                                    }
                                    break;
                            }
                        }
                        if (piece1.kart.prev.thisCoordinate.xvalue == piece1.connectionCoordinate4.xvalue && piece1.kart.prev.thisCoordinate.yvalue == piece1.connectionCoordinate4.yvalue) {
                            switch (piece1.kart.direction) {
                                case "Left":
                                    Coordinate next = piece1.connectionCoordinate1;
                                    Piece piece2 = pieces.stream().filter(piece3 -> piece3.thisCoordinate.xvalue == next.xvalue &&
                                            piece3.thisCoordinate.yvalue == next.yvalue).findFirst().get();
                                    if (piece2.kart != null || piece2.futureKart != null) {
                                        System.out.println("CRASH: " + piece2.thisCoordinate.xvalue + ", " + piece2.thisCoordinate.yvalue);
                                        piece1.kart = null;
                                        piece1.futureKart = null;
                                        piece2.kart = null;
                                        piece2.futureKart = null;continue;
                                    } else {
                                        piece2.futureKart = piece1.kart;
                                        piece2.futureKart.direction = "Middle";
                                        piece2.futureKart.prev = piece1;
                                    }
                                    break;
                                case "Middle":
                                    Coordinate next2 = piece1.connectionCoordinate2;
                                    Piece piece3 = pieces.stream().filter(piece4 -> piece4.thisCoordinate.xvalue == next2.xvalue &&
                                            piece4.thisCoordinate.yvalue == next2.yvalue).findFirst().get();
                                    if (piece3.kart != null || piece3.futureKart != null) {
                                        System.out.println("CRASH: " + piece3.thisCoordinate.xvalue + ", " + piece3.thisCoordinate.yvalue);
                                        piece1.kart = null;
                                        piece1.futureKart = null;
                                        piece3.kart = null;
                                        piece3.futureKart = null;continue;
                                    } else {
                                        piece3.futureKart = piece1.kart;
                                        piece3.futureKart.direction = "Right";
                                        piece3.futureKart.prev = piece1;
                                    }
                                    break;
                                case "Right":
                                    Coordinate next3 = piece1.connectionCoordinate3;
                                    Piece piece4 = pieces.stream().filter(piece5 -> piece5.thisCoordinate.xvalue == next3.xvalue &&
                                            piece5.thisCoordinate.yvalue == next3.yvalue).findFirst().get();
                                    if (piece4.kart != null|| piece4.futureKart != null) {
                                        System.out.println("CRASH: " + piece4.thisCoordinate.xvalue + ", " + piece4.thisCoordinate.yvalue);
                                        piece1.kart = null;
                                        piece1.futureKart = null;
                                        piece4.kart = null;
                                        piece4.futureKart = null;continue;
                                    } else {
                                        piece4.futureKart = piece1.kart;
                                        piece4.futureKart.direction = "Left";
                                        piece4.futureKart.prev = piece1;
                                    }
                                    break;
                            }
                        }
                    } else {
                        if (piece1.kart.prev.thisCoordinate.xvalue == piece1.connectionCoordinate1.xvalue && piece1.kart.prev.thisCoordinate.yvalue == piece1.connectionCoordinate1.yvalue) {
                            Coordinate next = piece1.connectionCoordinate2;
                            Piece piece2 = pieces.stream().filter(piece3 -> piece3.thisCoordinate.xvalue == next.xvalue &&
                                    piece3.thisCoordinate.yvalue == next.yvalue).findFirst().get();

                            if (piece2.kart != null || piece2.futureKart != null) {
                                System.out.println("CRASH: " + piece2.thisCoordinate.xvalue + ", " + piece2.thisCoordinate.yvalue);
                                piece1.kart = null;
                                piece1.futureKart = null;
                                piece2.kart = null;
                                piece2.futureKart = null;continue;
                            } else {
                                piece2.futureKart = piece1.kart;
                                piece2.futureKart.prev = piece1;
                            }
                        } else if (piece1.kart.prev.thisCoordinate.xvalue == piece1.connectionCoordinate2.xvalue && piece1.kart.prev.thisCoordinate.yvalue == piece1.connectionCoordinate2.yvalue) {
                            Coordinate next = piece1.connectionCoordinate1;
                            Piece piece2 = pieces.stream().filter(piece3 -> piece3.thisCoordinate.xvalue == next.xvalue &&
                                    piece3.thisCoordinate.yvalue == next.yvalue).findFirst().get();
                            if (piece2.kart != null || piece2.futureKart != null) {
                                System.out.println("CRASH: " + piece2.thisCoordinate.xvalue + ", " + piece2.thisCoordinate.yvalue);
                                piece1.kart = null;
                                piece1.futureKart = null;
                                piece2.kart = null;
                                piece2.futureKart = null;continue;
                            } else {
                                piece2.futureKart = piece1.kart;
                                piece2.futureKart.prev = piece1;
                            }
                        } else {
                            System.out.println("dit mag niet");
                        }
                    }
                    piece1.kart = null;
                }
            }
            for (Piece piece1 : pieces) {
                if (piece1.futureKart != null) {
                    piece1.kart = piece1.futureKart;
                    piece1.futureKart = null;
                }
            }
            int total = (int) pieces.stream().filter(piece -> piece.kart != null).count();
            System.out.println("Totaal: " + total);
            if (total == 1) {
                System.out.println(pieces.stream().filter(piece -> piece.kart != null).findFirst().get().thisCoordinate.xvalue + ", " + pieces.stream().filter(piece -> piece.kart != null).findFirst().get().thisCoordinate.yvalue);
                throw new Exception();
            }
        }
    }

    private static class Coordinate {

        public Coordinate(int a, int b) {
            this.xvalue = a;
            this.yvalue = b;
        }

        public int xvalue;
        public int yvalue;
        public Piece piece;
    }

    private static class Piece {

        public String direction = "Left";

        public Kart futureKart;
        public Coordinate thisCoordinate;
        public Coordinate connectionCoordinate1;
        public Coordinate connectionCoordinate2;

        public Coordinate connectionCoordinate3;
        public Coordinate connectionCoordinate4;
        public Kart kart;
    }

    private static class Kart {

        public boolean inverse;
        public String direction = "Left";
        public Piece prev;
    }
}
